<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Beijing Wu | Project | Domestic Flight Delay Predictions</title>
    <meta name="description" content="Beijing Wu | Project | Domestic Flight Delay Predictions">

    <!-- Bootstrap & MDB -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

    <!-- Styles -->
    <link rel="shortcut icon" href="/assets/img/favicon.ico">
    <link rel="stylesheet" href="/assets/css/main.css">

    <link rel="canonical" href="/">

    <!-- Theming-->
    <script src="/assets/js/theme.js"></script>

    <!-- Start of Google Analytics code ID -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-162315295-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-162315295-1');
    </script>
    <!-- End of Google Analytics code ID -->

    <style>
        table {
            border: 1px solid black;
            border-collapse: collapse;
            width: 100%;
        }
        
        th, td {
            border: 1px solid black;
            text-align: center;
            padding: 4px;
        }
        
        tr:nth-child(even) {background-color: #f2f2f2;}
    </style>

    <script async="true" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=AM_CHTML"> </script>

</head>

<body class="fixed-top-nav">

    <!-- Header -->
    <header>

        <!-- Nav Bar -->
        <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
            <div class="container">

                <!-- Social Icons -->
                <div class="row ml-1 ml-sm-0">
                    <span class="contact-icon text-center">

                        <a href="https://github.com/wubeijing" target="_blank" title="GitHub"><i class="fab fa-github"></i></a>
                        <a href="https://www.linkedin.com/in/beijing-wu-39aabb91/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
                        <a href="/assets/pdf/BeijingWu_2020_v02.pdf" target="_blank" title="Resume"><i class="fab fa-readme"></i></a>
                    
                    </span>
                </div>

                <!-- Navbar Toogle -->
                <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

                <div class="collapse navbar-collapse text-right" id="navbarNav">
                    <ul class="navbar-nav ml-auto flex-nowrap">

                        <!-- About -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/">ABOUT</a>
                        </li>

                        <!-- Projects -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/projects/">PROJECTS<span class="sr-only">(current)</span></a>
                        </li>

                        <!-- Skills -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/skills/">SKILLS</a>
                        </li>
						
                        <!-- Publications -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/publication/">PUBLICATIONS</a>
                        </li>

                        <div class="toggle-container">
                            <a id="light-toggle">
                                <i class="fas fa-moon"></i>
                                <i class="fas fa-sun"></i>
                            </a>
                        </div>

                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <!-- CONTENT -->
    <div class="container mt-5">
        <div class="post">

            <header class="post-header">
                <h2 id="tic-tac-toe"><a href="https://github.com/wubeijing/DomesticFlightDelayPredictions.git" target="_blank">Domestic Flight Delay Predictions At Scale</a></h2>
                <p>
                    <strong>Machine Learning, Big Data | PySpark, Databricks </strong><br><i>August 2022</i>
                </p>
                <hr />
            </header>

            <article>

                <!-- Content -->
                <p>
                    <a href="https://github.com/wubeijing/DomesticFlightDelayPredictions.git" target="_blank"><img src="../../assets/img/flight_delay_pipeline.png" class="card-img-top" /></a>
                </p>
                <hr />

                <h4 id="project-description">Introduction</h4>
                <p>Flight delays are a widespread issue worldwide, and can cause financial losses, the dissatisfaction of passengers, time losses, loss of reputation and bad business relations (<a href="https://www.fabec.eu/images/user-pics/pdf-downloads/Czech_Factors%20Influencing%20Flight%20Delays%20of%20a%20European%20Airline.pdf" target="_blank">Zámková et al.</a>). In the post-COVID world, travel demand increases, but supply, in the form of airport staffing, pilots, etc., struggles to keep up. Therefore, it is more important than ever for airports to be able to predict flight delays in order to help reduce strain on the air travel system.
                <br><br>The goal of this project is to help airports with their operations by predicting flight delays, so the airports can be strategic with turnaround services such as aircraft refueling, restocking, baggage handling, air traffic control, and gate management. Using US domestic flight and weather data from 2015 to 2021, along with airport information, we predict departure flight delays two hours prior to planned departure time.
                </p>

                <h4 id="project-description">Evaluation Metrics to Measure Success</h4>
                <p>We use F2-score, Matthews Correlation Coefficient (MCC), and balanced accuracy to evaluate our models' performance. These evaluation metrics are chosen to align with the business needs of our project. 
                <br><br><b>F2-score</b> is a weighted harmonic mean of precision and recall, and it gives more weight to recall than to precision, which means false positives are considered not as bad as than false negatives. If a flight that is predicted to be delayed depatures on time (false positive), the airport will not have a substantial monetary loss, whereas if an actual delay is failed to be identified (false negative), it will have a cascading effect on subsequent flights, baggage handling, air traffic control, and gate management for the airport. 
                <br><center>
                    `F_(2) = 5 xx frac(text{precision} xx text{recall})(4 xx text{precision} + text{recall}) text{ where } text{precision} = frac(text{TP})(text{TP} + text{FP}) text{ and } text{recall} = frac(text{TP})(text{TP} + text{FN})`
                </center>
                <br><b>Matthews Correlation Coefficient (MCC)</b> represents the confusion matrix as a single number, and helps with imbalanced data. MCC takes into account the proportion of each class. This metric ranges from -1 to 1, and -1 indicates the model is predicting the opposite class from the actual value, 0 is similar to random guessing, and 1 indicates a perfect classification.
                <br><center>
                    `text{MCC} = frac(text{TP} xx text{TN} - text{FP} xx text{FN})(sqrt ((text{TP} + text{FP})(text{TP} + text{FN})(text{TN} + text{FP})(text{TN} + text{FN})))`
                </center>
                <br><b>Balanced Accuracy</b>: Since the data is imbalanced, a normal accuracy metric will be high just by predicting the majority class, which is misleading. Instead, we choose to use balanced accuracy, which takes into account different class sizes.
                <br><center>
                    `text{Balanced Accuracy} = frac(text{sensitivity} + text{specificity})(2} text{ where } text{sensitivity} = frac(text{TP})(text{TP} + text{FN}) text{ and } text{specificity} = frac(text{TN})(text{TN} + text{FP})`
                </center>
                </p>

                <h4 id="skills">Skills</h4>
                <p>Machine Learning At Scale</p>

                <h4 id="tools">Tools</h4>
                <p>Python, PySpark, Databricks</p>
                <hr />

                <h4 id="algorithm">Automated Image Preprocessing and Model Development Pipeline</h4>
                <p>We implemented a series of 6 image preprocessing functions, all of which have the same goal, that is, to preserve and maximize useful features in the images and to decrease computational costs. 
                    
                </p>

                <h4 id="algorithm">Model Evaluation</h4>
                <p>
                <table style="width:100%">
                    <caption style="caption-side: top;">Optimal Model Parameters and Performance Using Training Data</caption>
                    <tr>
                        <th>Group</th>
                        <th>Model</th>
                        <th>Hyperparameters</th>
                        <th>Preprocessing</th>
                        <th>Cross Validated F1 Score</th>
                    </tr>
                    <tr>
                        <th>Distance Based</th>
                        <th>KNN</th>
                        <th style="text-align: left">n_neighbor=1, p=1, weights="uniform"</th>
                        <th style="text-align: left">Resized to 16x16</th>
                        <th>0.9742</th>
                    </tr>
                    <tr>
                        <th rowspan="2" scope="rowgroup">Naive Bayes</th>
                        <th scope="row">Bernoulli Model</th>
                        <th style="text-align: left">var_smoothing=1e-11</th>
                        <th style="text-align: left">Resized to 128x128, normalized box filter blurring with filter kernal (3, 3), max pooling with pool size (8, 8)</th>
                        <th>0.716</th>
                    </tr>
                    <tr>
                        <th scope="row">Gaussian Model</th>
                        <th style="text-align: left">var_smoothing=1e-11</th>
                        <th style="text-align: left">Resized to 128x128, max pooling with pool size (16, 16)</th>
                        <th>0.729</th>
                    </tr>
                    <tr>
                        <th rowspan="2" scope="rowgroup">Tree Based</th>
                        <th scope="row">Random Forest</th>
                        <th style="text-align: left">min_samples_leaf=3, n_estimators=500</th>
                        <th style="text-align: left">Resized to 32x32, Gaussian blur</th>
                        <th>0.9615</th>
                    </tr>
                    <tr>
                        <th scope="row">Gradient Boosted Classification Tree (GBCT)</th>
                        <th style="text-align: left">max_depth=4, n_estimators=500</th>
                        <th style="text-align: left">Resized to 16x16</th>
                        <th>0.9703</th>
                    </tr>
                    <tr>
                        <th>Linear Models</th>
                        <th scope="row">Logistic Regression</th>
                        <th style="text-align: left">C=0.001, penalty="l2", solvers="lbfgs"</th>
                        <th style="text-align: left">Resized to 256x256, max pooling with pool size (2, 2)</th>
                        <th>0.945</th>
                    </tr>
                </table>
                
                <br>
                <table style="width:100%">
                    <caption style="caption-side: top;">Test Data Evaluation</caption>
                    <tr>
                        <th>Model</th>
                        <th>True Healthy, Predicted Healthy (TN)</th>
                        <th>True Healthy, Predicted Cancer (FP)</th>
                        <th>True Cancer, Predicted Healthy (FN)</th>
                        <th>True Cancer, Predicted Cancer (TP)</th>
                        <th>F1 Score</th>
                        <th>Accuracy</th>
                        <th>True Cancer Detection Rate</th>
                        <th>False Positive Rate</th>
                    </tr>
                    <tr>
                        <th>KNN</th>
                        <th>628</th>
                        <th>18</th>
                        <th>11</th>
                        <th>723</th>
                        <th>0.9803</th>
                        <th>0.9790</th>
                        <th>0.985</th>
                        <th>0.028</th>
                    </tr>
                    <tr>
                        <th>Bernoulli Naive Bayes</th>
                        <th>188</th>
                        <th>458</th>
                        <th>69</th>
                        <th>665</th>
                        <th>0.716</th>
                        <th>0.618</th>
                        <th>0.906</th>
                        <th>0.709</th>
                    </tr>
                    <tr>
                        <th>Gaussian Naive Bayes</th>
                        <th>272</th>
                        <th>374</th>
                        <th>99</th>
                        <th>635</th>
                        <th>0.729</th>
                        <th>0.657</th>
                        <th>0.865</th>
                        <th>0.579</th>
                    </tr>
                    <tr>
                        <th>GBCT</th>
                        <th>612</th>
                        <th>34</th>
                        <th>16</th>
                        <th>718</th>
                        <th>0.966</th>
                        <th>0.964</th>
                        <th>0.978</th>
                        <th>0.053</th>
                    </tr>
                    <tr>
                        <th>Logistic Regression</th>
                        <th>596</th>
                        <th>50</th>
                        <th>23</th>
                        <th>711</th>
                        <th>0.947</th>
                        <th>0.951</th>
                        <th>0.969</th>
                        <th>0.077</th>
                    </tr>
                </table>
                <br>
                </p>

                

                <hr />
                <p>See the complete project in my <a href="https://github.com/wubeijing/DomesticFlightDelayPredictions.git" target="_blank">GitHub repository.</a></p>

            </article>
        </div>
    </div>

    <!-- Footer -->
    <footer class="fixed-bottom">
        <div class="container mt-0">
            &copy; Copyright 2022 Beijing Wu. Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>. Last updated: Jan 05, 2023.
        </div>
    </footer>
</body>

<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

<!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

<!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>

</html>