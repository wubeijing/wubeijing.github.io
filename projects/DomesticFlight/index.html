<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Beijing Wu | Project | Domestic Flight Delay Predictions</title>
    <meta name="description" content="Beijing Wu | Project | Domestic Flight Delay Predictions">

    <!-- Bootstrap & MDB -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

    <!-- Styles -->
    <link rel="shortcut icon" href="/assets/img/favicon.ico">
    <link rel="stylesheet" href="/assets/css/main.css">

    <link rel="canonical" href="/">

    <!-- Theming-->
    <script src="/assets/js/theme.js"></script>

    <!-- Start of Google Analytics code ID -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-162315295-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-162315295-1');
    </script>
    <!-- End of Google Analytics code ID -->

    <style>
        table {
            border: 1px solid black;
            border-collapse: collapse;
            width: 100%;
        }
        
        th, td {
            border: 1px solid black;
            text-align: center;
            padding: 4px;
        }
        
        tr:nth-child(even) {background-color: #f2f2f2;}
    </style>

    <script async="true" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=AM_CHTML"> </script>

</head>

<body class="fixed-top-nav">

    <!-- Header -->
    <header>

        <!-- Nav Bar -->
        <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
            <div class="container">

                <!-- Social Icons -->
                <div class="row ml-1 ml-sm-0">
                    <span class="contact-icon text-center">

                        <a href="https://github.com/wubeijing" target="_blank" title="GitHub"><i class="fab fa-github"></i></a>
                        <a href="https://www.linkedin.com/in/beijing-wu-39aabb91/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
                        <a href="/assets/pdf/BeijingWu_2020_v02.pdf" target="_blank" title="Resume"><i class="fab fa-readme"></i></a>
                    
                    </span>
                </div>

                <!-- Navbar Toogle -->
                <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

                <div class="collapse navbar-collapse text-right" id="navbarNav">
                    <ul class="navbar-nav ml-auto flex-nowrap">

                        <!-- About -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/">ABOUT</a>
                        </li>

                        <!-- Projects -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/projects/">PROJECTS<span class="sr-only">(current)</span></a>
                        </li>

                        <!-- Skills -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/skills/">SKILLS</a>
                        </li>
						
                        <!-- Publications -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/publication/">PUBLICATIONS</a>
                        </li>

                        <div class="toggle-container">
                            <a id="light-toggle">
                                <i class="fas fa-moon"></i>
                                <i class="fas fa-sun"></i>
                            </a>
                        </div>

                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <!-- CONTENT -->
    <div class="container mt-5">
        <div class="post">

            <header class="post-header">
                <h2 id="tic-tac-toe"><a href="https://github.com/wubeijing/DomesticFlightDelayPredictions.git" target="_blank">Domestic Flight Delay Predictions At Scale</a></h2>
                <p>
                    <strong>Machine Learning, Big Data | PySpark, Databricks </strong><br><i>August 2022</i>
                </p>
                <hr />
            </header>

            <article>

                <!-- Content -->
                <p>
                    <a href="https://github.com/wubeijing/DomesticFlightDelayPredictions.git" target="_blank"><img src="../../assets/img/flight_delay_pipeline.png" class="card-img-top" /></a>
                </p>
                <hr />

                <h4 id="project-description">Introduction</h4>
                <p>Flight delays are a widespread issue worldwide, and can cause financial losses, the dissatisfaction of passengers, time losses, loss of reputation and bad business relations (<a href="https://www.fabec.eu/images/user-pics/pdf-downloads/Czech_Factors%20Influencing%20Flight%20Delays%20of%20a%20European%20Airline.pdf" target="_blank">Zámková et al.</a>). In the post-COVID world, travel demand increases, but supply, in the form of airport staffing, pilots, etc., struggles to keep up. Therefore, it is more important than ever for airports to be able to predict flight delays in order to help reduce strain on the air travel system.
                <br><br>The goal of this project is to help airports with their operations by predicting flight delays, so the airports can be strategic with turnaround services such as aircraft refueling, restocking, baggage handling, air traffic control, and gate management. Using US domestic flight and weather data from 2015 to 2021, along with airport information, we predict departure flight delays two hours prior to planned departure time.
                </p>

                <h4 id="project-description">Evaluation Metrics to Measure Success</h4>
                <p>We use F2-score, Matthews Correlation Coefficient (MCC), and balanced accuracy to evaluate our models' performance. These evaluation metrics are chosen to align with the business needs of our project. 
                <br><br><b>F2-score</b> is a weighted harmonic mean of precision and recall, and it gives more weight to recall than to precision, which means false positives are considered not as bad as than false negatives. If a flight that is predicted to be delayed depatures on time (false positive), the airport will not have a substantial monetary loss, whereas if an actual delay is failed to be identified (false negative), it will have a cascading effect on subsequent flights, baggage handling, air traffic control, and gate management for the airport. 
                <br><br><center>
                    `F_(2) = 5 xx frac(text{precision} xx text{recall})(4 xx text{precision} + text{recall}) text{ where } text{precision} = frac(text{TP})(text{TP} + text{FP}) text{ and } text{recall} = frac(text{TP})(text{TP} + text{FN})`
                </center>
                <br><b>Matthews Correlation Coefficient (MCC)</b> represents the confusion matrix as a single number, and helps with imbalanced data. MCC takes into account the proportion of each class. This metric ranges from -1 to 1, and -1 indicates the model is predicting the opposite class from the actual value, 0 is similar to random guessing, and 1 indicates a perfect classification.
                <br><br><center>
                    `text{MCC} = frac(text{TP} xx text{TN} - text{FP} xx text{FN})(sqrt ((text{TP} + text{FP})(text{TP} + text{FN})(text{TN} + text{FP})(text{TN} + text{FN})))`
                </center>
                <br><b>Balanced Accuracy</b>: Since the data is imbalanced, a normal accuracy metric will be high just by predicting the majority class, which is misleading. Instead, we choose to use balanced accuracy, which takes into account different class sizes.
                <br><br><center>
                    `text{Balanced Accuracy} = frac(text{sensitivity} + text{specificity})(2} text{ where } text{sensitivity} = frac(text{TP})(text{TP} + text{FN}) text{ and } text{specificity} = frac(text{TN})(text{TN} + text{FP})`
                </center>
                </p>

                <h4 id="skills">Skills</h4>
                <p>Machine Learning At Scale</p>

                <h4 id="tools">Tools</h4>
                <p>Python, PySpark, Databricks</p>
                <hr />

                <h4 id="algorithm">Datasets</h4>
                <p>The primary datasets are domestic flight and airport information data from the U.S. Department of Transportation (DOT), weather data from the National Oceanic and Atmospheric Administration repository, and weather stations data from the U.S. DOT. <a href="https://www.transtats.bts.gov/Fields.asp?gnoyr_VQ=FGJ&flf_gnoyr_anzr=g_bagVZR_eRcbegVaT&h5r4_gnoyr_anzr=er2146v0t%20Pn44vr4%20b0-gvzr%20cr4s14zn0pr%20(EMLK-24r5r06)&lrn4_V0s1=E&Sv456_lrn4=EMLK&Yn56_lrn4=FDFE&en6r_V0s1=D&S4r37r0pB=Z106uyB&Qn6n_S4r37r0pB=N007ny,d7n46r4yB,Z106uyB" target="_blank" style="color:#2C6BAC; font-weight:bold">The flight dataset</a> contains information about domestic passenger flights on-time performance between 2015 - 2021. There are 107 features, of which the <b>DEP_DEL15 (departure delay 15 minutes or more)</b> is the target variable. The weather dataset contains hourly weather condition information from 2015 - 2021. The weather station dataset contains weather stations' information and neighboring stations along with distance between stations.
                <br><br>To supplement, we used airline codes, holidays, and airline operation category datasets. <a href="https://www.bts.gov/topics/airlines-and-airports/airline-codes" target="_blank" style="color:#2C6BAC; font-weight:bold">The airline codes data</a> provides airline names and associated IATA and ICAO codes. <a href="https://www.transtats.bts.gov/holidaydelay.asp" target="_blank" style="color:#2C6BAC; font-weight:bold">The holidays data</a> lists holiday travel seasons as defined by the air travel industry. <a href="https://www.airlinepilotcentral.com/airlines" target="_blank" style="color:#2C6BAC; font-weight:bold">The airline operation category data</a> categorizes airline carriers by their operation cost structures.
                </p>

                <h4 id="algorithm">Exploratory Data Analysis (EDA)</h4>
                <p>
                    <ul>
                        <li><b>Flight Dataset</b></li>
                        This dataset contains information about domestic passenger flights on-time performance between 2015 - 2021. There are 107 features, of which the <b>DEP_DEL15 (departure delay 15 minutes or more)</b> is the target variable. DEP_DEL15 = 0 indicates that the flight is not delayed and DEP_DEL15 = 1 represents delayed flights. Based on EDA on a subset of 3 month flight data, around 3% of data is missing DEP_DEL15 feature, which indicates flight cancellations. We consider these indefinite delays. Around 30% of flights in the flight dataset depart delayed, suggesting significant class imbalancing issue.
                        <br>In addition, the flight dataset contains 50% duplicated records, which are removed.
                        <br>
                        <li><b>Weather Dataset</b></li>
                        This dataset is collected from National Oceanic and Atmospheric Administration repository, with granular, high frequency weather information from monitoring weather stations all over the U.S. The dataset contains a large number of missing values, and columns with greater than 70% missing data are removed. 
                        <br>According to the Federal Aviation Administration, inclement weather, including thunderstorms, snowstorms, wind shear, icing, and fog, creates potentially hazardous conditions in the nation's airspace system. These conditions are, by far, the largest cause of flight delays. In an average year, inclement weather is the reason for nearly 70% of all delays. We thoroughly analyze the features in the weather data, and only features that are indicators of inclement weather are retained.
                        <br>
                        <li><b>Station Dataset</b></li>
                        This dataset contains information of weather stations and distances between neighboring stations. Stations with distance_to_neighbor = 0 represent weather monitoring stations at the airport, and only these stations are retained.
                      </ul>
                <br>
                </p>

                <h4 id="algorithm">Join Datasets</h4>
                <p>For all datasets, columns containing greater than 70% missing data are removed. All datasets are cleaned before joining. Flight dataset contains 42,430,592 records. Weather dataset contains 3,056,388 records, and station dataset contains 16,689 records.
                <br><br>Joining dataset is performed with the following join criteria: flight dataset left join with station dataset and left join with weather dataset on ICAO code in flight dataset = ICAO code in station dataset, on station id in station dataset = station id in weather dataset, on year in weather dataset = year in flight dataset. The following filtering criteria are followed: the difference between flight UTC timestamp and weather dataset timestamp should range between 2 (inclusive) and 5 hours prior flight departure time. The weather data is aggregated within a two hour window prior to prediction time. Depending on the weather features, aggregation can be average (i.e., rain fall volume), maximum (i.e., wind speed), or minimum (i.e., visibility). The flight UTC timestamp should always be greater than weather data timestamp. 
                </p>

                <h4 id="algorithm">Feature Engineering</h4>
                <p>
                    <table style="width:100%">
                        <tr>
                            <th>New Feature</th>
                            <th>Description</th>
                            <th>Data Type</th>
                        </tr>
                        <tr>
                            <th>Carrier Category</th>
                            <th style="text-align: left">There is a clear trend that certain airlines have higher percentage of delayed flights. Many of these airlines are considered low cost (JetBlue) or ultra-low cost (Spirit, Frontier) carriers while other airline carriers have fewer percentage of delayed flights. This new feature categorizes airlines into carriers. (Figure 1A, 1B)</th>
                            <th>categorical</th>
                        </tr>
                        <tr>
                            <th>Holidays: Pre- and Post-Holiday</th>
                            <th style="text-align: left">Airline travel can be seasonal, and certain holidays have much heavier traffic. We create 3 binary indicators to indicate whether flight depature dates are a holiday, pre-holiday, or post-holiday.</th>
                            <th>binary</th>
                        </tr>
                        <tr>
                            <th>Airport Importance (PageRank)</th>
                            <th style="text-align: left">Certain airports can be considered "travel hubs" and have more activities (and hence potentially more delays) than others. We use pagerank to find the importance of each airport, creating a new feature to indicate the importance of each flight's origin airport (i.e., how busy the airport is). (Figure 1C)</th>
                            <th>numerical</th>
                        </tr>
                        <tr>
                            <th>Prior Flight's Late Arrival</th>
                            <th style="text-align: left">We believe there is a chaining effect of late arriving flights causing future delayed flights, and we hypothesize that this has the largest impact on flight departure delays. By tracking each flight's tail number, we create a binary feature that indicates whether the plane was arrived late prior depature. Based on our research, there can be room to "make up" for late arrival; therefore, only flights arriving late for more than 30 minutes are considered late enough to affect the next flight depature time. (Figure 1D)</th>
                            <th>binary</th>
                        </tr>
                    </table>
                <br>
                Figure 1. New features
                <br><a href="https://github.com/wubeijing/DomesticFlightDelayPredictions.git" target="_blank"><img src="../../assets/img/flight_delay_figure_1.png" class="card-img-top" /></a>
                </p>

                <h4 id="algorithm">Model Pipeline</h4>
                <p>
                </p>

                <h4 id="algorithm">Model Performance</h4>
                <p>
                </p>

                <h4 id="algorithm">Challenges and Future Opportunities</h4>
                <p>
                </p>

                <hr />
                <p>See the complete project in my <a href="https://github.com/wubeijing/DomesticFlightDelayPredictions.git" target="_blank">GitHub repository.</a></p>

            </article>
        </div>
    </div>

    <!-- Footer -->
    <footer class="fixed-bottom">
        <div class="container mt-0">
            &copy; Copyright 2022 Beijing Wu. Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>. Last updated: Jan 12, 2023.
        </div>
    </footer>
</body>

<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

<!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

<!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>

</html>